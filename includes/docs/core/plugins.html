<h1 id="plugins">Plugins</h1>

<p>As of actionhero version <code class="prettyprint">v8.0.0</code>, you can create and include plugins for you actionhero project.  Plugins are collections of <code class="prettyprint">tasks</code>, <code class="prettyprint">actions</code>, <code class="prettyprint">servers</code>, and <code class="prettyprint">initializers</code> that are collected as a module.  You can install plugins via NPM or keep them in a local path.</p>

<p>Plugins are loaded after all local actionhero project files, but initializers follow the same priority scheme as all other initializers.</p>

<h2 id="including-plugins">Including Plugins</h2>

<p><code class="prettyprint">api.config.general.paths.plugin</code> (loaded from <code class="prettyprint">/config/api.js</code>) is an array which contains the search path for your plugins.  This will default to <code class="prettyprint">./node_modules</code>, but you can add a local path to your project.  Once you have the plugin search paths set up, you use <code class="prettyprint">npm run actionhero link -- --name nameOfPlugin</code> (or <code class="prettyprint">./node_modules/actionhero link --name nameOfPlugin</code>, which is equivalent) to create links in your top-level project to the plugin.  This will also copy over any config files from the plugin into your project so you can modify them.  The act of &ldquo;linking&rdquo; simply creates a <code class="prettyprint">myPlugin.link</code> file in each component of your top-level project (actions, tasks, etc) which tells actionhero to load up files at boot from that plugin.  </p>

<p>You can delete all (or some) links at any time.</p>

<h2 id="creating-plugins">Creating Plugins</h2>
<pre class="highlight shell"><code>/
| - actions
| - tasks
| - servers
| - initializers
| - scripts
| - config
|
| - package.json
</code></pre>

<p>To create a plugin, create a project with the following structure:</p>

<p>This structure will allow elements to be loaded into actionhero (we search <code class="prettyprint">/actions</code> for actions, <code class="prettyprint">/tasks</code> for tasks, etc)</p>

<p>When developing your plugin locally, you can load it into an existing actionhero project to test it out.</p>

<p>First, add the path your plugin is in to <code class="prettyprint">api.config.general.paths.plugin</code>.  If your actionhero app is in <code class="prettyprint">/var/ah/actionhero</code> and your plugin is in <code class="prettyprint">/var/ah/my_plugin</code>, add <code class="prettyprint">/var/ah</code> to <code class="prettyprint">api.config.general.paths.plugin</code></p>

<p><strong>Please use the npm naming convention <code class="prettyprint">ah-(name)-plugin</code> when uploading your plugin to npm</strong></p>

<h2 id="changes-in-v13-0-0">Changes in V13.0.0</h2>

<p>The plugin system was significantly changes in Actionhero version <code class="prettyprint">13.0.0</code>.  Older plugins will not work.<br>
- <code class="prettyprint">config/plugins.js</code> has been removed in favor of the linking system
- Config files from within plugins are no longer sourced
- There should be no more postinstall scripts needed, and as such, none are executed
- Be sure that your plugin is OS-independant. Use path.sep for file path separators and things like that. Use relative paths for everything in your plugin.</p>

<h2 id="plugin-methods">Plugin methods</h2>

<p>When creating plugins, you may find yourself wanting to do things which could normally be accomplished easily with a &ldquo;top level&rdquo; actionhero project, but might be difficult from within the <code class="prettyprint">node_modules</code> folder.  Here are some helpers:</p>

<h3 id="routes">Routes:</h3>

<ul>
<li><code class="prettyprint">api.routes.registerRoute(method, path, action, apiVersion, matchTrailingPathParts)</code>

<ul>
<li>Add a route to the system.<br></li>
</ul></li>
</ul>

<h2 id="example-plugin">Example Plugin</h2>

<p><a href="https://github.com/evantahler/ah-sample-plugin">You can view a sample plugin here</a></p>

<h2 id="published-plugins">Published Plugins</h2>

<ul>
<li><a href="https://github.com/evantahler/ah-stats-plugin">ah-stats-plugin</a> Stats Integration (redis backed)</li>
<li><a href="https://github.com/evantahler/ah-airbrake-plugin">ah-airbrake-plugin</a> Airbrake Integration</li>
<li><a href="https://github.com/evantahler/ah-newrelic-plugin">ah-newrelic-plugin</a> NewRelic Integration</li>
<li><a href="https://github.com/evantahler/ah-sequelize-plugin">ah-sequelize-plugin</a> Sequelize Integration for mySQL or Postgres</li>
<li><a href="https://github.com/panjiesw/ah-nodemailer-plugin">ah-nodemailer-plugin</a> Nodemailer Integration</li>
<li><a href="https://github.com/innerdvations/ah-ratelimit-plugin">ah-ratelimit-plugin</a> Rate Limits</li>
<li><a href="https://github.com/innerdvations/ah-autosession-plugin">ah-autosession-plugin</a> Sessions (based off of redis-sessions)</li>
<li><a href="https://github.com/S3bb1/ah-dashboard-plugin">ah-dashboard-plugin</a> Dashboard for ActionHero</li>
<li><a href="https://github.com/lookaflyingdonkey/ah-jwtauth-plugin">ah-jwtauth-plugin</a> JSON Web Token Authentication</li>
<li><a href="https://github.com/lookaflyingdonkey/ah-mongoose-plugin">ah-mongoose-plugin</a> Mongoose Model Loader</li>
<li><a href="https://github.com/lookaflyingdonkey/ah-xsignature-plugin">ah-xsignature-plugin</a> Content Checksum for Actions</li>
<li><a href="https://github.com/supamii/ah-swagger-plugin">ah-swagger-plugin</a> Swagger UI Documentation</li>
<li><a href="https://github.com/eduardogch/ah-mongodb-plugin">ah-mongodb-plugin</a> MongoDB + Mongoose</li>
<li><a href="https://github.com/eduardogch/ah-rethinkdb-plugin">ah-rethinkdb-plugin</a> RethinkDB + Mongoose</li>
</ul>
